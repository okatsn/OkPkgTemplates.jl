var documenterSearchIndex = {"docs":
[{"location":"extend/#Add-New-custom-templates","page":"Extend","title":"Add New custom templates","text":"","category":"section"},{"location":"extend/","page":"Extend","title":"Extend","text":"Please refer","category":"page"},{"location":"extend/#[The-use-of-genpkg](@ref-OkPkgTemplates.genpkg)","page":"Extend","title":"The use of genpkg","text":"","category":"section"},{"location":"extend/#[Create-and-use-a-new-pkg-generating-process](@ref-OkPkgTemplates.TemplateIdentifier)","page":"Extend","title":"Create and use a new pkg generating process","text":"","category":"section"},{"location":"internal/","page":"-","title":"-","text":"CurrentModule = OkPkgTemplates","category":"page"},{"location":"internal/#Reference","page":"-","title":"Reference","text":"","category":"section"},{"location":"internal/","page":"-","title":"-","text":"Modules = [OkPkgTemplates]","category":"page"},{"location":"internal/#OkPkgTemplates.commit_msg","page":"-","title":"OkPkgTemplates.commit_msg","text":"Notice\n\nCurrently, you have to add\n\n    client-payload: '{\"commit_msg\": \"${{ github.event.commits[0].message }}\"}'\n\n\nin register.yml manually.\n\nIn register.yml:\n\nwith Options for name: Trigger next workflow:\n\nclient-payload: passes data from Workflow 1 to Workflow 2\nExample:\nwith:\n  client-payload: '{\"ref\": \"${{ github.ref }}\", \"sha\": \"${{ github.sha }}\"}'\nCommit message can be obtained from both\n${{ github.event.commits[0].message }} and\n${{ github.event.head_commit.message }}\n(Not sure) the latter one could be empty\n(Not sure) error with the latter one could result from permission: content: false\nIt is possible to Iterating over github.event.commits or use join function to concatenate commits.\nAlternative way to Get a commit using curl.\nAlso see github context for what others are available.\nNoted that multiline string is not acceptable for json, you have to use e.g. \"# hello\\n second line\" istead as the commit message where Project.toml version is raised.\n\nBe aware if you have in several un-pushed commits that changes 'Project.toml', and push them at once, \"commit_msg\": \"${{ github.event.commits[0].message will be the first commit and it is not necessarily the commit to be registered. UpdateOkReg register a version for this package at the latest commit being pushed.\n\nNotice\n\nAs the latest commit you push is not necessary the commit you want to register, unexpected results will occurr if you push several commits among either of them 'Project.toml' is modified.\n\nFor example:\n\nYou have in several un-pushed commits that changes 'Project.toml', and push them at once, it register the version number of the lastest commit BUT client_payload (client-payload in register.yml) store and pass the information of the earliest commit in your push.\nYou add [compat] at the first commit with message \"Fix compatibility\", and increase the version number with message \"New keyword args. mkpath for mv2dir ...\". Both modify Project.toml, and the last one is registered but in release log it shows only \"Fix compatibility\".\n\nIf you want to automatically add commit message release note of the registered commit but you are too lazy to create pull requests since you are almost the only person working on YourPackage, please\n\npush everything else before you increase the version number, and\npush only the Project.toml with commit message you'd like to be adopted as release note.\n\n\n\n\n\n","category":"constant"},{"location":"internal/#OkPkgTemplates.logfile_msg","page":"-","title":"OkPkgTemplates.logfile_msg","text":"\n\n\n\n","category":"constant"},{"location":"internal/#OkPkgTemplates.TemplateIdentifier","page":"-","title":"OkPkgTemplates.TemplateIdentifier","text":"Create new template:\n\nInside OkPkgTemplates/src,\n\nadd concrete struct of Type{<:TemplateIdentifier}.\nadd a new templating expression (optional)\nadd a new method get_exprs for XXX\n\n# 1\nstruct XXX <: TemplateIdentifier end\n\n# 2\npkgtemplating_xxx(yourpkgname) = quote\n    t = Template(;\n        user=DEFAULT_USERNAME(),\n        dir=DEFAULT_DESTINATION(),\n        julia=DEFAULT_JULIAVER(),\n        plugins=[\n            Git(; manifest=false),\n            PLUGIN_COMPATHELPER(),\n            PLUGIN_GITHUBACTION(),\n            Codecov(), # https://about.codecov.io/\n            Documenter{GitHubActions}(),\n            PkgTemplates.Readme(),\n            PkgTemplates.TagBot(; changelog=tagbot_changelog()),\n            PLUGIN_TEST(),\n            RegisterAction()\n        ]\n    )\n\n    t($yourpkgname)\nend\n\n# 3\nget_exprs(::Type{XXX}) = [pkgtemplating_xxx, updateprojtoml_script]\n\nUse the new template\n\nGenerate: genpkg(\"HelloMyPkg\", XXX)\n\nUpdate: update(XXX)\n\n\n\n\n\n","category":"type"},{"location":"internal/#OkPkgTemplates.PLUGIN_REGISTER-Tuple{}","page":"-","title":"OkPkgTemplates.PLUGIN_REGISTER","text":"PLUGIN_REGISTER() by default uses templates in /home/runner/work/OkPkgTemplates.jl/OkPkgTemplates.jl/mypkgtemplates/for_okregistry/github/workflows/register.yml.\n\nIn the default template, job attempts to register the latest pushed commit of YourPackage where Project.toml is modified. If success, TagBot.yml will be triggered. See also PLUGIN_TAGBOT.\n\nIf Project.toml is modified but version number unchanged, it simply failed and you don't have to worry about anything.\n\nKnown issue\n\nAccording to the default \"register.yml\", in the workflow \"Register Package to OkRegistry\" both the repo of YourPackage and OkRegistry is checked out, and register YourPackage to OkRegistry using PAT ACCESS_OKREGISTRY token that must be provided in advance via your Github account. By default,  actions/checkout checkout the commit of the pushed event.\n\nAfter the current version is successfully registerd, TagBot will be triggered. However, if there is something wrong in tagging the previous version, that is a version exists in OkRegistry but failed to be tagged with TagBot, TagBot will stop at that version; and thus, succeeding versions cannot be tagged. See README for trouble shooting.\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.PLUGIN_TAGBOT-Tuple{}","page":"-","title":"OkPkgTemplates.PLUGIN_TAGBOT","text":"PLUGIN_TAGBOT() returns an PkgTemplates.TagBot. You can redefine this function.\n\nBy default it add github.event.client_payload.logfile_msg as part of the release note. Please must read Known issue in the doc of PLUGIN_REGISTER().\n\nChangelog\n\nFor variables that you can use in the changelog template, see line 174-184, tagbot/action/changelog.py and TagBot/Changelogs. Which are\n\n\"compare_url\"\n\"custom\"\n\"issues\"\n\"package\"\n\"previous_release\"\n\"pulls\"\n\"sha\"\n\"version\"\n\"version_url\"\n\nAlso see\n\nDefault changelog template.\n\nMore information\n\nsee PkgTemplates/src/plugins/tagbot.jl.\nIf your registry is public, you don't need to provide token. For more information, see here\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.copymyfiles_script-Tuple{Any}","page":"-","title":"OkPkgTemplates.copymyfiles_script","text":"Copy some files from repo0 to repo1. List of files:\n\nAll files under .github/workflows\n\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.generate-Tuple","page":"-","title":"OkPkgTemplates.generate","text":"generate(args...) evaluate the expressions returned by genpkg, and it takes exactly the same argument as genpkg.\n\nExample\n\ngenerate(\"MyNewProject\", GeneralReg)\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.genpkg-Tuple{Any, Type{<:OkPkgTemplates.TemplateIdentifier}}","page":"-","title":"OkPkgTemplates.genpkg","text":"genpkg(yourpkgname, tp::Type{<:TemplateIdentifier}) call @chkdest, and fall back to genpkg(yourpkgname, get_exprs(tp)...).\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.genpkg-Tuple{Any, Vararg{Function}}","page":"-","title":"OkPkgTemplates.genpkg","text":"genpkg(yourpkgname::String, fs...) execute scripts fs one by one in user's scope using OkPkgTemplates's utilities.\n\nPlease define OkPkgTemplates.DEFAULT_** for changing defaults.\n\nIf OkPkgTemplates.DEFAULT_DESTINATION() is not defined, it is defined as Pkg.devdir() at user's scope in the first use.\n\ntip: Tip\nIn julia REPL,key in OkPkgTemplates.DEFAULT_ and [tab] to list all functions that returns default variables\nkey in OkPkgTemplates.PLUGIN_ and [tab] to list all functions that returns ::PkgTemplates.Plugin presets.\nRedefine these functions in the local scope to assign the variable.\n\nExample\n\nTo specify output destination, redefine DEFAULT_DESTINATION()\n\nOkPkgTemplates.DEFAULT_DESTINATION() = pwd()\n\nand then generate the Package\n\nt = genpkg(\"MyNewProject\", GeneralReg)\nOkPkgTemplates.eval(t)\n\ntip: Resource\nPkgTemplates/Saving-Templates:\nPkgTemplates.user_view: Extending-Existing-Plugins\n\nAlso see the helps\n\ncopymyfiles_script\nupdateprojtoml_script\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.get_exprs-Tuple{Type{<:OkPkgTemplates.TemplateIdentifier}}","page":"-","title":"OkPkgTemplates.get_exprs","text":"\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.mypkgtemplate_dir-Tuple{Vararg{AbstractString}}","page":"-","title":"OkPkgTemplates.mypkgtemplate_dir","text":"Return a path relative to the default template file directory (OkPkgTemplates/mypkgtemplates).\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.pkgtemplating_gereg-Tuple{Any}","page":"-","title":"OkPkgTemplates.pkgtemplating_gereg","text":"pkgtemplating_gereg(yourpkgname) returns the script of PkgTemplates (quote ... end) for general registry.\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.pkgtemplating_okreg-Tuple{Any}","page":"-","title":"OkPkgTemplates.pkgtemplating_okreg","text":"pkgtemplating_okreg(yourpkgname) returns the script of PkgTemplates (quote ... end) to be executed at the scope that the macro is called.\n\nIt\n\ncreates a package using PkgTemplates.Templates\nadd Documenter, CompatHelperLocal, Test into Project.toml\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.stringscore-Tuple{Any}","page":"-","title":"OkPkgTemplates.stringscore","text":"stringscore(str) gives an absolute score for a string; the order of score from large to small corresponds to the alphabetical order. For a string less than 100 characters, the score should not exceeds one.\n\nExample\n\njulia> stringscore.([\"AAA\", \"Aa\", \"BCD\"])\n3-element Vector{Float64}:\n 0.0656565\n 0.06597\n 0.06667680000000001\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.upactions-Tuple{Any, Any, Type{<:OkPkgTemplates.TemplateIdentifier}}","page":"-","title":"OkPkgTemplates.upactions","text":"upactions(mod::Module, TI::Type{<:TemplateIdentifier}) return expressions for updating CIs, referencing the path of mod.\n\nExample\n\nusing MyPkgWhereCIToBeUpdated\nexprs = upactions($MyPkgWhereCIToBeUpdated $GeneralReg)\nfor ex in exprs\n    @eval(OkPkgTemplates, $ex)\nend\n\nwarning: Warning\nMake sure all your action files (all the files in .github/workflows) is under the control of git for safety.\n\nAlso see the helps\n\ncopymyfiles_script\nupdateprojtoml_script\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.upactions-Tuple{Type{<:OkPkgTemplates.TemplateIdentifier}}","page":"-","title":"OkPkgTemplates.upactions","text":"upactions return expressions for updating CIs using upactions referencing the path of the current activated project environment.\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.update-Tuple","page":"-","title":"OkPkgTemplates.update","text":"Overwrite/Update Github actions of the repository of the julia package in development; make sure the pacakge is under version control that the process can be reverted.\n\nExample\n\nActivate environment OkPkgTemplates:\n\npkg> activate .\n(OkPkgTemplates) pkg> dev OkFiles\n    Resolving package versions...\n    Updating `~/.julia/dev/OkPkgTemplates/Project.toml`\n    [b25a35d4] + OkFiles v0.4.1 `~/.julia/dev/OkFiles`\n    Updating `~/.julia/dev/OkPkgTemplates/Manifest.toml`\n    [b25a35d4] + OkFiles v0.4.1 `~/.julia/dev/OkFiles`\n\nUpdate CIs in OkFiles:\n\njulia> using OkPkgTemplates, OkFiles\njulia> update(OkFiles, GeneralReg)\n\nupdate execute expressions returned by upactions one-by-one.\n\nRunning update overwrite/update Github actions of the repository of the currently activated julia package; make sure they are under version control that the process can be reverted.\n\nExample\n\nActivate environment OkPkgTemplates:\n\npkg> activate .\n(OkPkgTemplates) pkg>\n\nUpdate CIs in OkPkgTemplates:\n\njulia> using OkPkgTemplates\njulia> update(GeneralReg)\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.updateprojtoml_script-Tuple{Any}","page":"-","title":"OkPkgTemplates.updateprojtoml_script","text":"After making the template successfully, add \"Documenter\", \"CompatHelperLocal\" to [extras] and [targets] as runtests.jl (may) use them.\n\nupdateprojtoml_script(yourpkgname) creates expressions in which projtoml_path = joinpath(OkPkgTemplates.DEFAULT_DESTINATION(), yourpkgname, \"Project.toml\").\n\nIt modify Project.toml by add [extras] and [targets] for the scope of Test.\n\n\n\n\n\n","category":"method"},{"location":"internal/#OkPkgTemplates.@chkdest-Tuple{}","page":"-","title":"OkPkgTemplates.@chkdest","text":"@chkdest check whether OkPkgTemplates.DEFAULT_DESTINATION() is defined. It define OkPkgTemplates.DEFAULT_DESTINATION() = Pkg.devdir() if DEFAULT_DESTINATION() is empty.\n\n\n\n\n\n","category":"macro"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = OkPkgTemplates","category":"page"},{"location":"#OkPkgTemplates","page":"Home","title":"OkPkgTemplates","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for OkPkgTemplates.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"tutorial/#Interface","page":"Tutorial","title":"Interface","text":"","category":"section"},{"location":"tutorial/#[generate](@ref-OkPkgTemplates.generate)","page":"Tutorial","title":"generate","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"OkPkgTemplates.generate","category":"page"},{"location":"tutorial/#OkPkgTemplates.generate-tutorial","page":"Tutorial","title":"OkPkgTemplates.generate","text":"generate(args...) evaluate the expressions returned by genpkg, and it takes exactly the same argument as genpkg.\n\nExample\n\ngenerate(\"MyNewProject\", GeneralReg)\n\n\n\n\n\n","category":"function"},{"location":"tutorial/#[update](@ref-OkPkgTemplates.update)","page":"Tutorial","title":"update","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"OkPkgTemplates.update","category":"page"},{"location":"tutorial/#OkPkgTemplates.update-tutorial","page":"Tutorial","title":"OkPkgTemplates.update","text":"Overwrite/Update Github actions of the repository of the julia package in development; make sure the pacakge is under version control that the process can be reverted.\n\nExample\n\nActivate environment OkPkgTemplates:\n\npkg> activate .\n(OkPkgTemplates) pkg> dev OkFiles\n    Resolving package versions...\n    Updating `~/.julia/dev/OkPkgTemplates/Project.toml`\n    [b25a35d4] + OkFiles v0.4.1 `~/.julia/dev/OkFiles`\n    Updating `~/.julia/dev/OkPkgTemplates/Manifest.toml`\n    [b25a35d4] + OkFiles v0.4.1 `~/.julia/dev/OkFiles`\n\nUpdate CIs in OkFiles:\n\njulia> using OkPkgTemplates, OkFiles\njulia> update(OkFiles, GeneralReg)\n\nupdate execute expressions returned by upactions one-by-one.\n\nRunning update overwrite/update Github actions of the repository of the currently activated julia package; make sure they are under version control that the process can be reverted.\n\nExample\n\nActivate environment OkPkgTemplates:\n\npkg> activate .\n(OkPkgTemplates) pkg>\n\nUpdate CIs in OkPkgTemplates:\n\njulia> using OkPkgTemplates\njulia> update(GeneralReg)\n\n\n\n\n\n","category":"function"},{"location":"tutorial/#List-of-available-[TemplateIdentifier](@ref-OkPkgTemplates.TemplateIdentifier)","page":"Tutorial","title":"List of available TemplateIdentifier","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"using OkPkgTemplates, InteractiveUtils, Markdown\nstrs = join(\"- \" .* string.(subtypes(OkPkgTemplates.TemplateIdentifier)), \"\\n\")\nMarkdown.parse(strs)","category":"page"}]
}
